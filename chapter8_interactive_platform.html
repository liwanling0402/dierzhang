<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬8ç«  - é«˜çº§æ•°æ®å¯è§†åŒ–äº¤äº’å¹³å°</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 10px;
        }

        .header p {
            text-align: center;
            color: #666;
            font-size: 1.1em;
        }

        .container {
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        }

        .chart-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }

        .chart-description {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .chart-container {
            height: 400px;
            position: relative;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .controls {
            margin-top: 20px;
            padding: 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .control-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 150px;
        }

        .control-item label {
            font-weight: bold;
            color: #555;
            font-size: 0.9em;
        }

        .control-item select,
        .control-item input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            background: white;
        }

        .control-item select:focus,
        .control-item input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .info-panel {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .info-panel h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .info-item {
            padding: 15px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .info-item h4 {
            color: #667eea;
            margin-bottom: 8px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #667eea;
            font-weight: bold;
        }

        .loading::after {
            content: '';
            width: 20px;
            height: 20px;
            margin-left: 10px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .feature-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .control-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>ç¬¬8ç«  é«˜çº§æ•°æ®å¯è§†åŒ–äº¤äº’å¹³å°</h1>
            <p>æ¢ç´¢10ç§ä¸“ä¸šé«˜çº§å›¾è¡¨ç±»å‹ï¼šç­‰é«˜çº¿å›¾ã€çŸ¢é‡åœºæµçº¿å›¾ã€æ£‰æ£’å›¾ã€å“‘é“ƒå›¾ã€ç”˜ç‰¹å›¾ã€äººå£é‡‘å­—å¡”å›¾ã€æ¼æ–—å›¾ã€æ¡‘åŸºå›¾ã€æ ‘çŠ¶å›¾ã€åå¤«é¥¼å›¾</p>
        </div>
    </header>

    <div class="container">
        <div class="info-panel">
            <h3>ğŸ“Š æœ¬ç« å›¾è¡¨æ¦‚è§ˆ</h3>
            <div class="info-grid">
                <div class="info-item">
                    <h4>ç­‰é«˜çº¿å›¾</h4>
                    <p>æ˜¾ç¤ºä¸‰ç»´æ•°æ®çš„åœ°å½¢å›¾ï¼Œç”¨äºè¡¨ç¤ºé«˜åº¦æˆ–å¯†åº¦åˆ†å¸ƒ</p>
                </div>
                <div class="info-item">
                    <h4>çŸ¢é‡åœºæµçº¿å›¾</h4>
                    <p>å±•ç¤ºå‘é‡åœºçš„æµåŠ¨æ¨¡å¼å’Œæ–¹å‘</p>
                </div>
                <div class="info-item">
                    <h4>æ£‰æ£’å›¾</h4>
                    <p>æ˜¾ç¤ºç¦»æ•£æ•°æ®ç‚¹åŠå…¶è¯¯å·®èŒƒå›´</p>
                </div>
                <div class="info-item">
                    <h4>å“‘é“ƒå›¾</h4>
                    <p>æ¯”è¾ƒä¸¤ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„å˜åŒ–æˆ–å·®å¼‚</p>
                </div>
                <div class="info-item">
                    <h4>ç”˜ç‰¹å›¾</h4>
                    <p>é¡¹ç›®ç®¡ç†ä¸­å±•ç¤ºä»»åŠ¡æ—¶é—´çº¿å’Œè¿›åº¦</p>
                </div>
                <div class="info-item">
                    <h4>äººå£é‡‘å­—å¡”å›¾</h4>
                    <p>å±•ç¤ºäººå£æŒ‰å¹´é¾„å’Œæ€§åˆ«çš„åˆ†å¸ƒç»“æ„</p>
                </div>
                <div class="info-item">
                    <h4>æ¼æ–—å›¾</h4>
                    <p>æ˜¾ç¤ºæµç¨‹ä¸­å„é˜¶æ®µçš„è½¬åŒ–ç‡å˜åŒ–</p>
                </div>
                <div class="info-item">
                    <h4>æ¡‘åŸºå›¾</h4>
                    <p>å±•ç¤ºèƒ½é‡æˆ–èµ„æºçš„æµåŠ¨å’Œåˆ†é…</p>
                </div>
                <div class="info-item">
                    <h4>æ ‘çŠ¶å›¾</h4>
                    <p>å±•ç¤ºå±‚æ¬¡ç»“æ„å’Œæ¯”ä¾‹å…³ç³»</p>
                </div>
                <div class="info-item">
                    <h4>åå¤«é¥¼å›¾</h4>
                    <p>ä»¥ç½‘æ ¼å½¢å¼å±•ç¤ºç™¾åˆ†æ¯”æ„æˆ</p>
                </div>
            </div>
        </div>

        <div class="charts-grid">
            <!-- ç­‰é«˜çº¿å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸ”ï¸ ç­‰é«˜çº¿å›¾</h3>
                <p class="chart-description">å±•ç¤ºä¸‰ç»´æ•°æ®çš„åœ°å½¢åˆ†å¸ƒï¼Œé«˜åº¦å€¼ç”¨ç­‰é«˜çº¿å’Œé¢œè‰²å¡«å……è¡¨ç¤º</p>
                <div class="chart-container" id="contour-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>ç­‰é«˜çº¿æ•°é‡</label>
                            <select id="contour-levels">
                                <option value="8">8</option>
                                <option value="12">12</option>
                                <option value="16">16</option>
                                <option value="20">20</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>é…è‰²æ–¹æ¡ˆ</label>
                            <select id="contour-colorscheme">
                                <option value="Viridis">Viridis</option>
                                <option value="Plasma">Plasma</option>
                                <option value="Hot">Hot</option>
                                <option value="Cool">Cool</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateContourPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- çŸ¢é‡åœºæµçº¿å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸŒŠ çŸ¢é‡åœºæµçº¿å›¾</h3>
                <p class="chart-description">æ˜¾ç¤ºå‘é‡åœºçš„æµåŠ¨æ¨¡å¼å’Œæ–¹å‘ï¼Œæµçº¿è¡¨ç¤ºæµä½“çš„è¿åŠ¨è½¨è¿¹</p>
                <div class="chart-container" id="stream-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>æµçº¿å¯†åº¦</label>
                            <select id="stream-density">
                                <option value="low">ä½</option>
                                <option value="medium" selected>ä¸­</option>
                                <option value="high">é«˜</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>çº¿æ¡å®½åº¦</label>
                            <select id="stream-width">
                                <option value="1">ç»†</option>
                                <option value="2" selected>ä¸­</option>
                                <option value="3">ç²—</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateStreamPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- æ£‰æ£’å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸŒ¾ æ£‰æ£’å›¾</h3>
                <p class="chart-description">æ˜¾ç¤ºç¦»æ•£æ•°æ®ç‚¹åŠå…¶è¯¯å·®èŒƒå›´ï¼Œå¸¸ç”¨äºç§‘å­¦æ•°æ®å¯è§†åŒ–</p>
                <div class="chart-container" id="stem-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>è¯¯å·®ç±»å‹</label>
                            <select id="stem-error-type">
                                <option value="constant">å›ºå®šè¯¯å·®</option>
                                <option value="variable">å¯å˜è¯¯å·®</option>
                                <option value="percentage">ç™¾åˆ†æ¯”è¯¯å·®</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æ•°æ®ç‚¹æ•°é‡</label>
                            <select id="stem-points">
                                <option value="10">10</option>
                                <option value="20" selected>20</option>
                                <option value="30">30</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateStemPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- å“‘é“ƒå›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸ‹ï¸ å“‘é“ƒå›¾</h3>
                <p class="chart-description">æ¯”è¾ƒä¸¤ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„å˜åŒ–æˆ–å·®å¼‚ï¼Œçªå‡ºæ˜¾ç¤ºè¿æ¥å…³ç³»</p>
                <div class="chart-container" id="dumbbell-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>ç±»åˆ«æ•°é‡</label>
                            <select id="dumbbell-categories">
                                <option value="5">5</option>
                                <option value="8" selected>8</option>
                                <option value="12">12</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æ’åºæ–¹å¼</label>
                            <select id="dumbbell-sort">
                                <option value="ascending">å‡åº</option>
                                <option value="descending">é™åº</option>
                                <option value="difference">å·®å€¼</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateDumbbellPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- ç”˜ç‰¹å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸ“… ç”˜ç‰¹å›¾</h3>
                <p class="chart-description">é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œæ˜¾ç¤ºä»»åŠ¡æ—¶é—´çº¿ã€ä¾èµ–å…³ç³»å’Œè¿›åº¦</p>
                <div class="chart-container" id="gantt-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>ä»»åŠ¡æ•°é‡</label>
                            <select id="gantt-tasks">
                                <option value="5">5</option>
                                <option value="8" selected>8</option>
                                <option value="12">12</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æ˜¾ç¤ºè¿›åº¦</label>
                            <select id="gantt-progress">
                                <option value="yes">æ˜¾ç¤º</option>
                                <option value="no">éšè—</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateGanttPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- äººå£é‡‘å­—å¡”å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸ‘¥ äººå£é‡‘å­—å¡”å›¾</h3>
                <p class="chart-description">å±•ç¤ºäººå£æŒ‰å¹´é¾„å’Œæ€§åˆ«çš„åˆ†å¸ƒç»“æ„ï¼Œåæ˜ äººå£å‘å±•è¶‹åŠ¿</p>
                <div class="chart-container" id="pyramid-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>å¹´é¾„ç»„æ•°</label>
                            <select id="pyramid-age-groups">
                                <option value="6">6ç»„</option>
                                <option value="8" selected>8ç»„</option>
                                <option value="10">10ç»„</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æ•°æ®ç±»å‹</label>
                            <select id="pyramid-data-type">
                                <option value="population">äººå£æ•°é‡</option>
                                <option value="percentage">ç™¾åˆ†æ¯”</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updatePyramidPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- æ¼æ–—å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸ”½ æ¼æ–—å›¾</h3>
                <p class="chart-description">æ˜¾ç¤ºæµç¨‹ä¸­å„é˜¶æ®µçš„è½¬åŒ–ç‡å˜åŒ–ï¼Œå¸¸ç”¨äºé”€å”®å’Œè¥é”€åˆ†æ</p>
                <div class="chart-container" id="funnel-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>æ¼æ–—ç±»å‹</label>
                            <select id="funnel-type">
                                <option value="sales">é”€å”®æ¼æ–—</option>
                                <option value="marketing">è¥é”€æ¼æ–—</option>
                                <option value="recruitment">æ‹›è˜æ¼æ–—</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æ˜¾ç¤ºæ•°å€¼</label>
                            <select id="funnel-values">
                                <option value="yes">æ˜¾ç¤º</option>
                                <option value="no">éšè—</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateFunnelPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- æ¡‘åŸºå›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸŒŠ æ¡‘åŸºå›¾</h3>
                <p class="chart-description">å±•ç¤ºèƒ½é‡æˆ–èµ„æºçš„æµåŠ¨å’Œåˆ†é…ï¼Œé€‚ç”¨äºæµé‡å’Œè½¬ç§»åˆ†æ</p>
                <div class="chart-container" id="sankey-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>èŠ‚ç‚¹æ•°é‡</label>
                            <select id="sankey-nodes">
                                <option value="4">4ä¸ªèŠ‚ç‚¹</option>
                                <option value="5" selected>5ä¸ªèŠ‚ç‚¹</option>
                                <option value="6">6ä¸ªèŠ‚ç‚¹</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æµå‘æ•°é‡</label>
                            <select id="sankey-flows">
                                <option value="simple">ç®€å•</option>
                                <option value="medium" selected>ä¸­ç­‰</option>
                                <option value="complex">å¤æ‚</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateSankeyPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- æ ‘çŠ¶å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸŒ³ æ ‘çŠ¶å›¾</h3>
                <p class="chart-description">å±•ç¤ºå±‚æ¬¡ç»“æ„å’Œæ¯”ä¾‹å…³ç³»ï¼Œé€‚ç”¨äºç»„ç»‡æ¶æ„å’Œæ•°æ®åˆ†è§£</p>
                <div class="chart-container" id="treemap-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>å±‚çº§æ·±åº¦</label>
                            <select id="treemap-depth">
                                <option value="2">2å±‚</option>
                                <option value="3" selected>3å±‚</option>
                                <option value="4">4å±‚</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>æ•°æ®ç±»å‹</label>
                            <select id="treemap-data">
                                <option value="budget">é¢„ç®—åˆ†é…</option>
                                <option value="sales">é”€å”®æ•°æ®</option>
                                <option value="population">äººå£åˆ†å¸ƒ</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateTreemapPlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>

            <!-- åå¤«é¥¼å›¾ -->
            <div class="chart-card">
                <h3 class="chart-title">ğŸ§‡ åå¤«é¥¼å›¾</h3>
                <p class="chart-description">ä»¥ç½‘æ ¼å½¢å¼å±•ç¤ºç™¾åˆ†æ¯”æ„æˆï¼Œé€‚åˆæ˜¾ç¤ºå®Œæˆåº¦æˆ–å æ¯”</p>
                <div class="chart-container" id="waffle-plot"></div>
                <div class="controls">
                    <div class="control-group">
                        <div class="control-item">
                            <label>ç½‘æ ¼å¤§å°</label>
                            <select id="waffle-size">
                                <option value="10x10">10Ã—10</option>
                                <option value="12x12" selected>12Ã—12</option>
                                <option value="15x15">15Ã—15</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>åˆ†ç±»æ•°é‡</label>
                            <select id="waffle-categories">
                                <option value="3">3ç±»</option>
                                <option value="4" selected>4ç±»</option>
                                <option value="5">5ç±»</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn" onclick="updateWafflePlot()">æ›´æ–°å›¾è¡¨</button>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <h3>ğŸ¯ å¹³å°ç‰¹è‰²åŠŸèƒ½</h3>
            <div class="feature-list">
                <div class="feature-item">å®æ—¶äº¤äº’å¼å›¾è¡¨</div>
                <div class="feature-item">å‚æ•°è‡ªå®šä¹‰è°ƒèŠ‚</div>
                <div class="feature-item">å“åº”å¼å¸ƒå±€è®¾è®¡</div>
                <div class="feature-item">å¹³æ»‘åŠ¨ç”»è¿‡æ¸¡</div>
                <div class="feature-item">æ•°æ®å¯¼å‡ºåŠŸèƒ½</div>
                <div class="feature-item">å›¾è¡¨ç¼©æ”¾å¹³ç§»</div>
                <div class="feature-item">å¤šä¸»é¢˜é…è‰²</div>
                <div class="feature-item">æ•°æ®ç»Ÿè®¡æ˜¾ç¤º</div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡å­˜å‚¨å›¾è¡¨å®ä¾‹
        let charts = {};

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        document.addEventListener('DOMContentLoaded', function() {
            initAllCharts();
        });

        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        function initAllCharts() {
            updateContourPlot();
            updateStreamPlot();
            updateStemPlot();
            updateDumbbellPlot();
            updateGanttPlot();
            updatePyramidPlot();
            updateFunnelPlot();
            updateSankeyPlot();
            updateTreemapPlot();
            updateWafflePlot();
        }

        // ç­‰é«˜çº¿å›¾
        function updateContourPlot() {
            const levels = parseInt(document.getElementById('contour-levels').value);
            const colorscheme = document.getElementById('contour-colorscheme').value;
            
            // ç”Ÿæˆæ•°æ®
            const size = 100;
            const x = [];
            const y = [];
            const z = [];
            
            for (let i = 0; i < size; i++) {
                x[i] = -2 + 4 * i / size;
                y[i] = -2 + 4 * i / size;
                z[i] = [];
                for (let j = 0; j < size; j++) {
                    const xi = -2 + 4 * i / size;
                    const yi = -2 + 4 * j / size;
                    z[i][j] = (1 - xi/2 + xi**5 + yi**3) * Math.exp(-xi**2 - yi**2);
                }
            }
            
            const data = [{
                x: x,
                y: y,
                z: z,
                type: 'contour',
                colorscale: colorscheme,
                contours: {
                    coloring: 'heatmap'
                },
                ncontours: levels,
                colorbar: {
                    title: 'é«˜åº¦å€¼'
                }
            }];
            
            const layout = {
                title: 'ä¸‰ç»´ç­‰é«˜çº¿å›¾',
                xaxis: { title: 'Xè½´' },
                yaxis: { title: 'Yè½´' },
                margin: { t: 30, r: 30, b: 40, l: 40 }
            };
            
            Plotly.newPlot('contour-plot', data, layout, {responsive: true});
        }

        // çŸ¢é‡åœºæµçº¿å›¾
        function updateStreamPlot() {
            const density = document.getElementById('stream-density').value;
            const width = parseInt(document.getElementById('stream-width').value);
            
            // ç”ŸæˆçŸ¢é‡åœºæ•°æ®
            const size = density === 'low' ? 15 : density === 'medium' ? 20 : 30;
            const x = [];
            const y = [];
            const u = [];
            const v = [];
            
            for (let i = 0; i < size; i++) {
                x[i] = [];
                y[i] = [];
                u[i] = [];
                v[i] = [];
                for (let j = 0; j < size; j++) {
                    const xi = -2 + 4 * i / size;
                    const yi = -2 + 4 * j / size;
                    x[i][j] = xi;
                    y[i][j] = yi;
                    u[i][j] = xi * Math.cos(xi + yi);
                    v[i][j] = yi * Math.sin(xi + yi);
                }
            }
            
            const data = [{
                type: 'stream',
                x: x,
                y: y,
                u: u,
                v: v,
                color: 'blue',
                linewidth: width,
                density: density === 'low' ? 0.8 : density === 'medium' ? 1.0 : 1.2
            }];
            
            const layout = {
                title: 'çŸ¢é‡åœºæµçº¿å›¾',
                xaxis: { title: 'Xè½´' },
                yaxis: { title: 'Yè½´' },
                margin: { t: 30, r: 30, b: 40, l: 40 }
            };
            
            Plotly.newPlot('stream-plot', data, layout, {responsive: true});
        }

        // æ£‰æ£’å›¾
        function updateStemPlot() {
            const errorType = document.getElementById('stem-error-type').value;
            const numPoints = parseInt(document.getElementById('stem-points').value);
            
            const x = [];
            const y = [];
            const error = [];
            
            for (let i = 0; i < numPoints; i++) {
                x.push(i + 1);
                const baseValue = Math.sin(i * 0.5) * 10 + 15;
                y.push(baseValue);
                
                if (errorType === 'constant') {
                    error.push(2);
                } else if (errorType === 'variable') {
                    error.push(Math.random() * 3 + 0.5);
                } else {
                    error.push(baseValue * 0.1);
                }
            }
            
            const data = [{
                type: 'scatter',
                x: x,
                y: y,
                mode: 'markers',
                error_y: {
                    type: 'data',
                    array: error,
                    visible: true,
                    color: 'rgba(100, 126, 234, 0.5)',
                    thickness: 2
                },
                marker: {
                    color: 'rgba(102, 126, 234, 0.8)',
                    size: 8,
                    line: { color: 'white', width: 1 }
                },
                line: { color: 'rgba(102, 126, 234, 0.6)', width: 2 }
            }];
            
            const layout = {
                title: 'æ£‰æ£’å›¾',
                xaxis: { title: 'æ•°æ®ç‚¹' },
                yaxis: { title: 'æ•°å€¼' },
                margin: { t: 30, r: 30, b: 40, l: 40 }
            };
            
            Plotly.newPlot('stem-plot', data, layout, {responsive: true});
        }

        // å“‘é“ƒå›¾
        function updateDumbbellPlot() {
            const numCategories = parseInt(document.getElementById('dumbbell-categories').value);
            const sortBy = document.getElementById('dumbbell-sort').value;
            
            const categories = [];
            const group1 = [];
            const group2 = [];
            
            for (let i = 0; i < numCategories; i++) {
                categories.push(`ç±»åˆ« ${i + 1}`);
                group1.push(Math.random() * 50 + 30);
                group2.push(Math.random() * 50 + 30);
            }
            
            // æ’åº
            if (sortBy === 'ascending') {
                const indices = Array.from(Array(numCategories).keys());
                indices.sort((a, b) => group1[a] - group1[b]);
                indices.forEach((idx, i) => {
                    categories[i] = `ç±»åˆ« ${idx + 1}`;
                    group1[i] = group1[idx];
                    group2[i] = group2[idx];
                });
            } else if (sortBy === 'descending') {
                const indices = Array.from(Array(numCategories).keys());
                indices.sort((a, b) => group1[b] - group1[a]);
                indices.forEach((idx, i) => {
                    categories[i] = `ç±»åˆ« ${idx + 1}`;
                    group1[i] = group1[idx];
                    group2[i] = group2[idx];
                });
            } else if (sortBy === 'difference') {
                const differences = group1.map((v, i) => v - group2[i]);
                const indices = Array.from(Array(numCategories).keys());
                indices.sort((a, b) => Math.abs(differences[b]) - Math.abs(differences[a]));
                indices.forEach((idx, i) => {
                    categories[i] = `ç±»åˆ« ${idx + 1}`;
                    group1[i] = group1[idx];
                    group2[i] = group2[idx];
                });
            }
            
            const trace1 = {
                y: categories,
                x: group1,
                type: 'scatter',
                mode: 'markers',
                name: 'ç»„åˆ« A',
                marker: { color: 'rgba(102, 126, 234, 0.8)', size: 10 }
            };
            
            const trace2 = {
                y: categories,
                x: group2,
                type: 'scatter',
                mode: 'markers',
                name: 'ç»„åˆ« B',
                marker: { color: 'rgba(118, 75, 162, 0.8)', size: 10 }
            };
            
            // æ·»åŠ è¿æ¥çº¿
            const connectionTraces = [];
            for (let i = 0; i < numCategories; i++) {
                connectionTraces.push({
                    x: [group1[i], group2[i]],
                    y: [categories[i], categories[i]],
                    type: 'scatter',
                    mode: 'lines',
                    line: { color: 'rgba(150, 150, 150, 0.3)', width: 2 },
                    showlegend: false,
                    hoverinfo: 'none'
                });
            }
            
            const data = [trace1, trace2, ...connectionTraces];
            
            const layout = {
                title: 'å“‘é“ƒå›¾',
                xaxis: { title: 'æ•°å€¼' },
                yaxis: { title: 'ç±»åˆ«' },
                margin: { t: 30, r: 30, b: 40, l: 60 },
                height: 400
            };
            
            Plotly.newPlot('dumbbell-plot', data, layout, {responsive: true});
        }

        // ç”˜ç‰¹å›¾
        function updateGanttPlot() {
            const numTasks = parseInt(document.getElementById('gantt-tasks').value);
            const showProgress = document.getElementById('gantt-progress').value === 'yes';
            
            const tasks = [];
            const startDates = [];
            const endDates = [];
            const progress = [];
            
            const startDate = new Date('2024-01-01');
            
            for (let i = 0; i < numTasks; i++) {
                tasks.push(`ä»»åŠ¡ ${i + 1}`);
                const start = new Date(startDate.getTime() + Math.random() * 30 * 24 * 60 * 60 * 1000);
                const duration = Math.random() * 20 + 5; // 5-25 days
                const end = new Date(start.getTime() + duration * 24 * 60 * 60 * 1000);
                
                startDates.push(start);
                endDates.push(end);
                progress.push(Math.random() * 100);
            }
            
            const data = [{
                x: startDates.map((date, i) => [date, endDates[i]]),
                y: tasks,
                type: 'scatter',
                mode: 'markers',
                marker: {
                    symbol: 'square',
                    size: 40,
                    color: progress.map(p => p / 100),
                    colorscale: 'RdYlGn',
                    colorbar: {
                        title: 'å®Œæˆåº¦',
                        x: 1.02
                    }
                },
                text: progress.map(p => `${p.toFixed(1)}%`),
                hovertemplate: 'ä»»åŠ¡: %{y}<br>å¼€å§‹: %{x[0]}<br>ç»“æŸ: %{x[1]}<br>è¿›åº¦: %{text}<extra></extra>'
            }];
            
            const layout = {
                title: 'ç”˜ç‰¹å›¾',
                xaxis: { title: 'æ—¥æœŸ' },
                yaxis: { title: 'ä»»åŠ¡' },
                margin: { t: 30, r: 100, b: 40, l: 60 },
                height: 400
            };
            
            Plotly.newPlot('gantt-plot', data, layout, {responsive: true});
        }

        // äººå£é‡‘å­—å¡”å›¾
        function updatePyramidPlot() {
            const ageGroups = parseInt(document.getElementById('pyramid-age-groups').value);
            const dataType = document.getElementById('pyramid-data-type').value === 'percentage';
            
            const ages = [];
            const male = [];
            const female = [];
            
            const maxAge = 80;
            const ageStep = maxAge / ageGroups;
            
            for (let i = 0; i < ageGroups; i++) {
                const ageStart = i * ageStep;
                const ageEnd = (i + 1) * ageStep;
                ages.push(`${ageStart.toFixed(0)}-${ageEnd.toFixed(0)}å²`);
                
                const baseMale = 100000 * Math.exp(-i * 0.3);
                const baseFemale = 110000 * Math.exp(-i * 0.28);
                
                male.push(-(baseMale + Math.random() * 20000 - 10000));
                female.push(baseFemale + Math.random() * 20000 - 10000);
            }
            
            if (dataType) {
                const totalMale = male.reduce((a, b) => a + Math.abs(b), 0);
                const totalFemale = female.reduce((a, b) => a + Math.abs(b), 0);
                male = male.map(v => (v / totalMale * 100).toFixed(1));
                female = female.map(v => (v / totalFemale * 100).toFixed(1));
            }
            
            const trace1 = {
                x: male,
                y: ages,
                type: 'bar',
                orientation: 'h',
                name: 'ç”·æ€§',
                marker: { color: 'rgba(102, 126, 234, 0.8)' }
            };
            
            const trace2 = {
                x: female,
                y: ages,
                type: 'bar',
                orientation: 'h',
                name: 'å¥³æ€§',
                marker: { color: 'rgba(118, 75, 162, 0.8)' }
            };
            
            const data = [trace1, trace2];
            
            const layout = {
                title: 'äººå£é‡‘å­—å¡”å›¾',
                xaxis: { 
                    title: dataType ? 'ç™¾åˆ†æ¯” (%)' : 'äººå£æ•°é‡',
                    range: dataType ? [-15, 15] : [-120000, 120000]
                },
                yaxis: { title: 'å¹´é¾„ç»„' },
                barmode: 'overlay',
                bargap: 0.1,
                margin: { t: 30, r: 30, b: 40, l: 60 },
                legend: { x: 0.5, y: -0.2, orientation: 'h' }
            };
            
            Plotly.newPlot('pyramid-plot', data, layout, {responsive: true});
        }

        // æ¼æ–—å›¾
        function updateFunnelPlot() {
            const funnelType = document.getElementById('funnel-type').value;
            const showValues = document.getElementById('funnel-values').value === 'yes';
            
            let stages, values, colors;
            
            switch (funnelType) {
                case 'sales':
                    stages = ['æ½œåœ¨å®¢æˆ·', 'æ„å‘å®¢æˆ·', 'å•†æœº', 'æŠ¥ä»·', 'æˆäº¤'];
                    values = [1000, 600, 300, 150, 50];
                    colors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd'];
                    break;
                case 'marketing':
                    stages = ['æ›å…‰', 'ç‚¹å‡»', 'è®¿é—®', 'æ³¨å†Œ', 'è½¬åŒ–'];
                    values = [10000, 3000, 1500, 500, 100];
                    colors = ['#ff7f0e', '#1f77b4', '#2ca02c', '#d62728', '#9467bd'];
                    break;
                case 'recruitment':
                    stages = ['ç®€å†æŠ•é€’', 'ç­›é€‰', 'åˆè¯•', 'å¤è¯•', 'å½•ç”¨'];
                    values = [500, 200, 100, 40, 20];
                    colors = ['#2ca02c', '#1f77b4', '#ff7f0e', '#d62728', '#9467bd'];
                    break;
            }
            
            const data = [{
                type: 'funnel',
                y: stages,
                x: values,
                text: showValues ? values.map(v => v.toLocaleString()) : undefined,
                textposition: showValues ? 'inside' : 'none',
                textinfo: showValues ? 'text+percent initial+percent previous' : 'percent initial',
                marker: { color: colors },
                hovertemplate: 'é˜¶æ®µ: %{y}<br>æ•°é‡: %{x}<br>è½¬åŒ–ç‡: %{percentInitial}<extra></extra>'
            }];
            
            const layout = {
                title: 'æ¼æ–—å›¾',
                margin: { t: 30, r: 30, b: 40, l: 60 }
            };
            
            Plotly.newPlot('funnel-plot', data, layout, {responsive: true});
        }

        // æ¡‘åŸºå›¾
        function updateSankeyPlot() {
            const numNodes = parseInt(document.getElementById('sankey-nodes').value);
            const flowComplexity = document.getElementById('sankey-flows').value;
            
            const nodes = [];
            const links = [];
            
            // åˆ›å»ºèŠ‚ç‚¹
            for (let i = 0; i < numNodes; i++) {
                nodes.push({
                    label: ['æºA', 'æºB', 'æºC', 'ä¸­è½¬1', 'ä¸­è½¬2', 'ç›®æ ‡1', 'ç›®æ ‡2', 'ç›®æ ‡3'][i] || `èŠ‚ç‚¹${i+1}`,
                    color: ['rgba(31, 119, 180, 0.8)', 'rgba(255, 127, 14, 0.8)', 'rgba(44, 160, 44, 0.8)', 
                           'rgba(214, 39, 40, 0.8)', 'rgba(148, 103, 189, 0.8)', 'rgba(140, 86, 75, 0.8)'][i % 7]
                });
            }
            
            // åˆ›å»ºè¿æ¥
            const numFlows = flowComplexity === 'simple' ? 3 : flowComplexity === 'medium' ? 5 : 8;
            
            for (let i = 0; i < numFlows; i++) {
                const source = Math.floor(Math.random() * Math.floor(numNodes / 2));
                const target = Math.floor(Math.random() * Math.floor(numNodes / 2)) + Math.floor(numNodes / 2);
                
                if (source !== target) {
                    links.push({
                        source: source,
                        target: target,
                        value: Math.random() * 30 + 10,
                        color: 'rgba(100, 100, 100, 0.5)'
                    });
                }
            }
            
            const data = [{
                type: 'sankey',
                domain: { x: [0, 1], y: [0, 1] },
                orientation: 'h',
                node: {
                    pad: 15,
                    thickness: 20,
                    line: { color: 'black', width: 0.5 },
                    label: nodes.map(n => n.label),
                    color: nodes.map(n => n.color)
                },
                link: {
                    source: links.map(l => l.source),
                    target: links.map(l => l.target),
                    value: links.map(l => l.value),
                    color: links.map(l => l.color)
                }
            }];
            
            const layout = {
                title: 'æ¡‘åŸºå›¾',
                margin: { t: 30, r: 30, b: 40, l: 40 }
            };
            
            Plotly.newPlot('sankey-plot', data, layout, {responsive: true});
        }

        // æ ‘çŠ¶å›¾
        function updateTreemapPlot() {
            const depth = parseInt(document.getElementById('treemap-depth').value);
            const dataType = document.getElementById('treemap-data').value;
            
            let data;
            
            switch (dataType) {
                case 'budget':
                    data = [{
                        type: 'treemap',
                        labels: ['æ€»é¢„ç®—', 'ç ”å‘éƒ¨é—¨', 'å¸‚åœºéƒ¨é—¨', 'è¿è¥éƒ¨é—¨', 'äººäº‹éƒ¨é—¨', 'è´¢åŠ¡éƒ¨é—¨'],
                        parents: ['', 'æ€»é¢„ç®—', 'æ€»é¢„ç®—', 'æ€»é¢„ç®—', 'æ€»é¢„ç®—', 'æ€»é¢„ç®—'],
                        values: [100, 35, 25, 20, 10, 10],
                        textinfo: 'label+value+percent parent',
                        marker: { colorscale: 'Blues' }
                    }];
                    break;
                case 'sales':
                    data = [{
                        type: 'treemap',
                        labels: ['æ€»é”€å”®', 'åŒ—åŒº', 'å—åŒº', 'ä¸œåŒº', 'è¥¿åŒº', 'çº¿ä¸Š', 'çº¿ä¸‹', 'åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³'],
                        parents: ['', 'æ€»é”€å”®', 'æ€»é”€å”®', 'æ€»é”€å”®', 'æ€»é”€å”®', 'æ€»é”€å”®', 'æ€»é”€å”®', 'åŒ—åŒº', 'å—åŒº', 'å—åŒº', 'å—åŒº'],
                        values: [100, 30, 25, 20, 15, 60, 40, 15, 10, 8, 7],
                        textinfo: 'label+value+percent parent',
                        marker: { colorscale: 'Greens' }
                    }];
                    break;
                case 'population':
                    data = [{
                        type: 'treemap',
                        labels: ['æ€»äººå£', 'åŸå¸‚', 'å†œæ‘', 'ä¸œéƒ¨', 'ä¸­éƒ¨', 'è¥¿éƒ¨', 'åŒ—äº¬', 'ä¸Šæµ·', 'å¿åŸ', 'ä¹¡é•‡', 'å±±åŒº'],
                        parents: ['', 'æ€»äººå£', 'æ€»äººå£', 'åŸå¸‚', 'åŸå¸‚', 'å†œæ‘', 'ä¸œéƒ¨', 'ä¸œéƒ¨', 'å†œæ‘', 'å†œæ‘', 'å†œæ‘'],
                        values: [100, 60, 40, 35, 15, 10, 20, 15, 20, 12, 8],
                        textinfo: 'label+value+percent parent',
                        marker: { colorscale: 'Reds' }
                    }];
                    break;
            }
            
            const layout = {
                title: 'æ ‘çŠ¶å›¾',
                margin: { t: 30, r: 30, b: 40, l: 40 }
            };
            
            Plotly.newPlot('treemap-plot', data, layout, {responsive: true});
        }

        // åå¤«é¥¼å›¾
        function updateWafflePlot() {
            const sizeSelect = document.getElementById('waffle-size').value;
            const categories = parseInt(document.getElementById('waffle-categories').value);
            
            const [rows, cols] = sizeSelect.split('x').map(Number);
            const totalCells = rows * cols;
            
            const categoryColors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd'];
            const categoryNames = ['ç±»åˆ«1', 'ç±»åˆ«2', 'ç±»åˆ«3', 'ç±»åˆ«4', 'ç±»åˆ«5'];
            const categoryValues = [];
            
            // ç”Ÿæˆéšæœºæ¯”ä¾‹
            let remaining = 100;
            for (let i = 0; i < categories - 1; i++) {
                const value = Math.random() * (remaining / (categories - i));
                categoryValues.push(value);
                remaining -= value;
            }
            categoryValues.push(remaining);
            
            const data = [];
            let currentCell = 0;
            
            for (let i = 0; i < categories; i++) {
                const cellCount = Math.round(categoryValues[i] / 100 * totalCells);
                const row = [];
                const col = [];
                const text = [];
                
                for (let j = 0; j < cellCount && currentCell < totalCells; j++) {
                    row.push(Math.floor(currentCell / cols));
                    col.push(currentCell % cols);
                    text.push('');
                    currentCell++;
                }
                
                if (row.length > 0) {
                    data.push({
                        type: 'scatter',
                        x: col,
                        y: row,
                        mode: 'markers',
                        marker: {
                            symbol: 'square',
                            size: 20,
                            color: categoryColors[i]
                        },
                        name: `${categoryNames[i]} (${categoryValues[i].toFixed(1)}%)`,
                        text: text,
                        hovertemplate: `${categoryNames[i]}<br>å æ¯”: ${categoryValues[i].toFixed(1)}%<extra></extra>`
                    });
                }
            }
            
            const layout = {
                title: 'åå¤«é¥¼å›¾',
                xaxis: { 
                    range: [-0.5, cols - 0.5],
                    tickvals: Array.from({length: cols}, (_, i) => i),
                    gridcolor: 'lightgray'
                },
                yaxis: { 
                    range: [-0.5, rows - 0.5],
                    tickvals: Array.from({length: rows}, (_, i) => i),
                    gridcolor: 'lightgray'
                },
                showlegend: true,
                margin: { t: 30, r: 150, b: 40, l: 40 },
                legend: { 
                    orientation: 'v',
                    x: 1.02,
                    y: 0.5
                }
            };
            
            Plotly.newPlot('waffle-plot', data, layout, {responsive: true});
        }
    </script>
</body>
</html>