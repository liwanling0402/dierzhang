<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬ä¸‰ç« æ•°æ®å¯è§†åŒ–å¹³å° - ç”µå•†é”€å”®ä¸è´¨é‡åˆ†æ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .control-group {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .chart-type-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .chart-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            background: #3498db;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: bold;
        }
        
        .chart-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .chart-btn.active {
            background: #e74c3c;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        }
        
        .dataset-select {
            padding: 12px 20px;
            border: 2px solid #3498db;
            border-radius: 25px;
            background: white;
            font-size: 14px;
            min-width: 250px;
        }
        
        .theme-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .theme-toggle {
            padding: 10px 20px;
            border: 2px solid #3498db;
            border-radius: 25px;
            background: white;
            color: #3498db;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            background: #3498db;
            color: white;
        }
        
        .chart-container {
            padding: 30px;
            min-height: 600px;
        }
        
        .chart-wrapper {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            height: 500px;
        }
        
        .data-info {
            background: #f8f9fa;
            padding: 20px;
            border-top: 1px solid #e9ecef;
        }
        
        .data-info h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .data-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .description {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            font-size: 14px;
            color: #666;
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .chart-type-buttons {
                justify-content: center;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            .chart-wrapper {
                height: 400px;
            }
            
            .data-stats {
                grid-template-columns: 1fr;
            }
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 18px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ç¬¬ä¸‰ç« æ•°æ®å¯è§†åŒ–å¹³å°</h1>
            <p>åŸºäºJupyterç¬”è®°æœ¬å†…å®¹çš„äº¤äº’å¼æ•°æ®å¯è§†åŒ– - ä¸‰è§’å‡½æ•°ã€ç®±å½¢å›¾ã€æ•£ç‚¹å›¾ã€æŠ˜çº¿å›¾ç­‰å¤šç§å›¾è¡¨ç±»å‹</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <div class="chart-type-buttons">
                    <button class="chart-btn active" onclick="switchChartType('line')">æŠ˜çº¿å›¾</button>
                    <button class="chart-btn" onclick="switchChartType('scatter')">æ•£ç‚¹å›¾</button>
                    <button class="chart-btn" onclick="switchChartType('boxplot')">ç®±å½¢å›¾</button>
                    <button class="chart-btn" onclick="switchChartType('bar')">æŸ±å½¢å›¾</button>
                    <button class="chart-btn" onclick="switchChartType('radar')">é›·è¾¾å›¾</button>
                </div>
                
                <select class="dataset-select" onchange="switchDataset(this.value)">
                    <option value="trigonometry">ä¸‰è§’å‡½æ•°æ•°æ®</option>
                    <option value="quality">é›¶ä»¶è´¨é‡åˆ†å¸ƒ</option>
                    <option value="sales">ç”µå•†é”€å”®é¢æ•°æ®</option>
                    <option value="cityExpense">åŸå¸‚æ¶ˆè´¹æ”¯å‡º</option>
                    <option value="movie">ç”µå½±ç¥¨æˆ¿æ•°æ®</option>
                    <option value="trend">è¶‹åŠ¿åˆ†ææ•°æ®</option>
                </select>
                
                <div class="theme-control">
                    <button class="theme-toggle" onclick="toggleTheme()">åˆ‡æ¢ä¸»é¢˜</button>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-wrapper">
                <div class="loading" id="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
                <canvas id="chartCanvas"></canvas>
            </div>
        </div>
        
        <div class="data-info">
            <h3>ğŸ“ˆ æ•°æ®åˆ†æä¸ç»Ÿè®¡</h3>
            <div class="data-stats" id="dataStats">
                <!-- åŠ¨æ€ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯ -->
            </div>
            <div class="description" id="chartDescription">
                <!-- åŠ¨æ€ç”Ÿæˆå›¾è¡¨æè¿° -->
            </div>
        </div>
    </div>

    <script>
        // å›¾è¡¨å®ä¾‹å’Œé…ç½®
        let chart = null;
        let currentChartType = 'line';
        let currentDataset = 'trigonometry';
        let isDarkTheme = false;

        // ç¬¬ä¸‰ç« æ•°æ®é›†ï¼ˆåŸºäºJupyterç¬”è®°æœ¬å†…å®¹ï¼‰
        const datasets = {
            trigonometry: {
                x: Array.from({length: 100}, (_, i) => i * Math.PI / 16),
                y1: Array.from({length: 100}, (_, i) => Math.sin(i * Math.PI / 16)),
                y2: Array.from({length: 100}, (_, i) => Math.cos(i * Math.PI / 16)),
                description: 'ä¸‰è§’å‡½æ•°æ•°æ®å¯è§†åŒ–ï¼šæ­£å¼¦å‡½æ•°(sin)å’Œä½™å¼¦å‡½æ•°(cos)åœ¨åŒºé—´[0, 6Ï€]ä¸Šçš„å›¾åƒã€‚æ­£å¼¦å‡½æ•°è¡¨ç¤ºå‘¨æœŸæ€§æŒ¯è¡ï¼Œä½™å¼¦å‡½æ•°ä¸æ­£å¼¦å‡½æ•°ç›¸ä½ä¸åŒã€‚',
                unit: 'æŒ¯å¹…'
            },
            quality: {
                labels: ['å·¥è‰ºA', 'å·¥è‰ºB', 'å·¥è‰ºC'],
                data: [
                    // å·¥è‰ºAï¼šé›†ä¸­åœ¨90-110ï¼ˆæ­£æ€åˆ†å¸ƒï¼‰
                    [90.1, 92.3, 95.7, 97.2, 98.5, 99.1, 100.4, 101.7, 102.9, 103.5, 104.2, 105.8, 106.3, 107.1, 108.6, 109.2, 110.1],
                    // å·¥è‰ºBï¼šé›†ä¸­åœ¨95-115ï¼ˆæ— å¼‚å¸¸å€¼ï¼‰
                    [95.2, 96.7, 97.8, 98.4, 99.3, 100.6, 101.9, 102.5, 103.7, 104.4, 105.1, 106.2, 107.5, 108.8, 109.6, 110.3, 111.2, 112.7, 113.4, 114.1],
                    // å·¥è‰ºCï¼šå«60ã€130å¼‚å¸¸å€¼ï¼ˆåŒ¹é…ç¬¬ä¸‰ç« çœŸå®æ•°æ®ï¼‰
                    [60, 75.4, 78.9, 82.3, 84.7, 87.1, 89.6, 92.8, 94.2, 96.5, 98.1, 100.7, 102.3, 104.9, 107.2, 109.4, 112.6, 115.8, 118.3, 120.7, 123.1, 125.4, 128.7, 130]
                ],
                description: 'é›¶ä»¶è´¨é‡åˆ†å¸ƒåˆ†æï¼šä¸‰ç§ä¸åŒå·¥è‰ºç”Ÿäº§çš„é›¶ä»¶è´¨é‡åˆ†å¸ƒç®±å½¢å›¾ï¼ˆåŸºäºç¬¬ä¸‰ç« çœŸå®æ•°æ®ï¼‰ã€‚ç®±å½¢å›¾æ˜¾ç¤ºæ•°æ®çš„äº”æ•°æ¦‚æ‹¬ï¼ˆæœ€å°å€¼ã€Q1ã€ä¸­ä½æ•°ã€Q3ã€æœ€å¤§å€¼ï¼‰ï¼Œå·¥è‰ºCåŒ…å«60å’Œ130ä¸¤ä¸ªå¼‚å¸¸å€¼ï¼Œç”¨äºæ¯”è¾ƒä¸åŒå·¥è‰ºçš„è´¨é‡ç¨³å®šæ€§ã€‚',
                unit: 'è´¨é‡ï¼ˆå…‹ï¼‰'
            },
            sales: {
                labels: ['ç”µå­äº§å“', 'æœè£…é‹å¸½', 'å®¶å±…ç™¾è´§', 'ç¾å¦†ä¸ªæŠ¤', 'é£Ÿå“ç”Ÿé²œ'],
                data: [550, 420, 280, 390, 610],
                description: 'ç”µå•†å¹³å°å„å“ç±»æœˆé”€å”®é¢ç»Ÿè®¡ã€‚å±•ç¤ºä¸åŒå•†å“ç±»åˆ«çš„é”€å”®è¡¨ç°ï¼Œä¾¿äºåˆ†æçƒ­é”€å“ç±»å’Œåˆ¶å®šè¥é”€ç­–ç•¥ã€‚',
                unit: 'ä¸‡å…ƒ'
            },
            cityExpense: {
                labels: ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³', 'æ­å·', 'æˆéƒ½'],
                data: [
                    [4200, 4800, 5200, 4500],  // åŒ—äº¬ï¼šå››ä¸ªå­£åº¦
                    [4500, 5200, 5500, 4800],  // ä¸Šæµ·
                    [3800, 4200, 4500, 4000],  // å¹¿å·
                    [4600, 5100, 5400, 4900],  // æ·±åœ³
                    [3500, 3900, 4200, 3800],  // æ­å·
                    [3200, 3600, 3900, 3500]   // æˆéƒ½
                ],
                seriesLabels: ['ç¬¬ä¸€å­£åº¦', 'ç¬¬äºŒå­£åº¦', 'ç¬¬ä¸‰å­£åº¦', 'ç¬¬å››å­£åº¦'],
                description: 'ä¸»è¦åŸå¸‚å­£åº¦æ¶ˆè´¹æ”¯å‡ºå¯¹æ¯”åˆ†æã€‚é€šè¿‡å¤šç»„æŸ±å½¢å›¾å±•ç¤ºä¸åŒåŸå¸‚åœ¨ä¸åŒå­£åº¦çš„æ¶ˆè´¹æ°´å¹³å˜åŒ–ã€‚',
                unit: 'å…ƒ'
            },
            movie: {
                x: Array.from({length: 30}, (_, i) => i + 1),
                y: Array.from({length: 30}, (_, i) => 50 + Math.sin(i * 0.3) * 30 + Math.random() * 10),
                description: 'ç”µå½±ç¥¨æˆ¿éšå¤©æ•°å˜åŒ–è¶‹åŠ¿ã€‚æ¨¡æ‹ŸçœŸå®ç¥¨æˆ¿æ•°æ®çš„éšæœºæ³¢åŠ¨ï¼Œå±•ç¤ºç”µå½±ä¸Šæ˜ æœŸé—´è§‚ä¼—çƒ­åº¦å˜åŒ–ã€‚',
                unit: 'ä¸‡äººæ¬¡'
            },
            trend: {
                labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                data: [
                    [65, 59, 80, 81, 56, 55, 70, 85, 75, 90, 82, 95],  // äº§å“A - å®Œæ•´12ä¸ªæœˆ
                    [28, 48, 40, 19, 86, 27, 62, 78, 55, 70, 45, 88],  // äº§å“B - å®Œæ•´12ä¸ªæœˆ
                    [45, 25, 16, 36, 67, 82, 58, 72, 65, 80, 52, 90],  // äº§å“C - å®Œæ•´12ä¸ªæœˆ
                    [72, 62, 50, 42, 38, 60, 75, 88, 82, 95, 85, 98],  // äº§å“D - å®Œæ•´12ä¸ªæœˆ
                    [38, 52, 67, 45, 80, 55, 65, 78, 72, 85, 70, 92]   // äº§å“E - å®Œæ•´12ä¸ªæœˆ
                ],
                seriesLabels: ['äº§å“A', 'äº§å“B', 'äº§å“C', 'äº§å“D', 'äº§å“E'],
                description: 'å¤šäº§å“æœˆé”€å”®é¢é›·è¾¾å›¾åˆ†æã€‚é€šè¿‡é›·è¾¾å›¾å±•ç¤º5ä¸ªä¸åŒäº§å“åœ¨12ä¸ªæœˆä»½çš„é”€å”®è¡¨ç°ã€‚æ¯ä¸ªäº§å“çš„æ•°æ®ç‚¹ä»£è¡¨äº†è¯¥äº§å“åœ¨ç›¸åº”æœˆä»½çš„é”€å”®é¢ï¼ˆå•ä½ï¼šåƒä»¶ï¼‰ï¼Œä¾¿äºè¿›è¡Œå¤šç»´åº¦æ¯”è¾ƒå’Œå¸‚åœºè¶‹åŠ¿åˆ†æã€‚é›·è¾¾å›¾èƒ½å¤Ÿç›´è§‚å±•ç¤ºå„äº§å“åœ¨ä¸åŒæœˆä»½çš„è¡¨ç°å·®å¼‚å’Œå­£èŠ‚æ€§è§„å¾‹ã€‚',
                unit: 'åƒä»¶'
            }
        };

        // é¢œè‰²é…ç½®
        const colors = {
            light: {
                primary: '#3498db',
                secondary: '#e74c3c',
                success: '#2ecc71',
                warning: '#f39c12',
                info: '#9b59b6',
                background: '#ffffff',
                text: '#2c3e50',
                grid: 'rgba(0, 0, 0, 0.1)'
            },
            dark: {
                primary: '#3498db',
                secondary: '#e74c3c',
                success: '#2ecc71',
                warning: '#f39c12',
                info: '#9b59b6',
                background: '#2c3e50',
                text: '#ecf0f1',
                grid: 'rgba(255, 255, 255, 0.1)'
            }
        };

        // è·å–å½“å‰ä¸»é¢˜é¢œè‰²
        function getThemeColors() {
            return isDarkTheme ? colors.dark : colors.light;
        }

        // è®¡ç®—ç®±å½¢å›¾çš„äº”æ•°æ¦‚æ‹¬
        function calculateBoxplotData(dataArray) {
            const sorted = [...dataArray].sort((a, b) => a - b);
            const q1 = sorted[Math.floor(sorted.length * 0.25)];
            const median = sorted[Math.floor(sorted.length * 0.5)];
            const q3 = sorted[Math.floor(sorted.length * 0.75)];
            const min = sorted[0];
            const max = sorted[sorted.length - 1];
            
            // è®¡ç®—å¼‚å¸¸å€¼ï¼ˆè¶…è¿‡1.5å€IQRçš„æ•°æ®ç‚¹ï¼‰
            const iqr = q3 - q1;
            const lowerBound = q1 - 1.5 * iqr;
            const upperBound = q3 + 1.5 * iqr;
            const outliers = sorted.filter(x => x < lowerBound || x > upperBound);
            
            return {
                min: Math.max(min, lowerBound),
                q1: q1,
                median: median,
                q3: q3,
                max: Math.min(max, upperBound),
                outliers: outliers
            };
        }

        // åˆå§‹åŒ–å›¾è¡¨
        function initChart() {
            const ctx = document.getElementById('chartCanvas');
            const loading = document.getElementById('loading');
            
            // æ˜¾ç¤ºåŠ è½½æç¤º
            loading.style.display = 'flex';
            ctx.style.display = 'none';
            
            setTimeout(() => {
                if (chart) {
                    chart.destroy();
                }
                
                const config = createChartConfig(currentChartType, datasets[currentDataset]);
                chart = new Chart(ctx, config);
                
                // éšè—åŠ è½½æç¤ºï¼Œæ˜¾ç¤ºå›¾è¡¨
                loading.style.display = 'none';
                ctx.style.display = 'block';
                
                updateStats();
                updateDescription();
            }, 100);
        }

        // åˆ›å»ºå›¾è¡¨é…ç½®
        function createChartConfig(type, dataset) {
            const themeColors = getThemeColors();
            
            const baseConfig = {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 1000,
                    easing: 'easeOutQuart'
                },
                plugins: {
                    legend: {
                        labels: {
                            color: themeColors.text,
                            font: { size: 12 }
                        }
                    },
                    tooltip: {
                        backgroundColor: themeColors.background,
                        titleColor: themeColors.text,
                        bodyColor: themeColors.text,
                        borderColor: themeColors.primary,
                        borderWidth: 1
                    }
                },
                scales: {
                    x: {
                        grid: { color: themeColors.grid },
                        ticks: { color: themeColors.text }
                    },
                    y: {
                        grid: { color: themeColors.grid },
                        ticks: { color: themeColors.text }
                    }
                }
            };

            switch (type) {
                case 'line':
                    return {
                        ...baseConfig,
                        type: 'line',
                        data: {
                            labels: dataset.x ? dataset.x.map(x => x.toFixed(2)) : dataset.labels,
                            datasets: [
                                {
                                    label: 'æ­£å¼¦å‡½æ•° (sin)',
                                    data: dataset.y1,
                                    borderColor: themeColors.primary,
                                    backgroundColor: themeColors.primary + '20',
                                    borderWidth: 3,
                                    fill: true,
                                    tension: 0.4
                                },
                                {
                                    label: 'ä½™å¼¦å‡½æ•° (cos)',
                                    data: dataset.y2,
                                    borderColor: themeColors.secondary,
                                    backgroundColor: themeColors.secondary + '20',
                                    borderWidth: 3,
                                    fill: true,
                                    tension: 0.4
                                }
                            ]
                        },
                        options: {
                            ...baseConfig,
                            plugins: {
                                ...baseConfig.plugins,
                                title: {
                                    display: true,
                                    text: dataset.description.split('ï¼š')[0],
                                    color: themeColors.text,
                                    font: { size: 16, weight: 'bold' }
                                }
                            },
                            scales: {
                                ...baseConfig.scales,
                                y: {
                                    ...baseConfig.scales.y,
                                    title: {
                                        display: true,
                                        text: dataset.unit,
                                        color: themeColors.text
                                    }
                                }
                            }
                        }
                    };

                case 'scatter':
                    return {
                        ...baseConfig,
                        type: 'scatter',
                        data: {
                            datasets: [{
                                label: dataset.description.split('ï¼š')[0],
                                data: dataset.x.map((x, i) => ({
                                    x: x,
                                    y: dataset.y[i]
                                })),
                                backgroundColor: themeColors.primary,
                                borderColor: themeColors.primary,
                                borderWidth: 2,
                                pointRadius: 6,
                                pointHoverRadius: 8
                            }]
                        },
                        options: {
                            ...baseConfig,
                            plugins: {
                                ...baseConfig.plugins,
                                title: {
                                    display: true,
                                    text: dataset.description.split('ï¼š')[0],
                                    color: themeColors.text,
                                    font: { size: 16, weight: 'bold' }
                                }
                            },
                            scales: {
                                x: {
                                    ...baseConfig.scales.x,
                                    title: {
                                        display: true,
                                        text: 'å¤©æ•°',
                                        color: themeColors.text
                                    }
                                },
                                y: {
                                    ...baseConfig.scales.y,
                                    title: {
                                        display: true,
                                        text: dataset.unit,
                                        color: themeColors.text
                                    }
                                }
                            }
                        }
                    };

                case 'boxplot':
                    // è®¡ç®—ç®±å½¢å›¾çš„äº”æ•°æ¦‚æ‹¬æ•°æ®
                    const boxplotData = dataset.data.map((arr, index) => {
                        const sorted = [...arr].sort((a, b) => a - b);
                        const q1 = sorted[Math.floor(sorted.length * 0.25)];
                        const median = sorted[Math.floor(sorted.length * 0.5)];
                        const q3 = sorted[Math.floor(sorted.length * 0.75)];
                        const min = sorted[0];
                        const max = sorted[sorted.length - 1];
                        
                        // è®¡ç®—IQRå’Œå¼‚å¸¸å€¼è¾¹ç•Œ
                        const iqr = q3 - q1;
                        const lowerBound = q1 - 1.5 * iqr;
                        const upperBound = q3 + 1.5 * iqr;
                        
                        return {
                            x: dataset.labels[index],
                            y: [min, q1, median, q3, max],
                            
                            // ä¸ºæ¡å½¢å›¾æ ·å¼å‡†å¤‡çš„æ•°æ®
                            min: min,
                            q1: q1,
                            median: median,
                            q3: q3,
                            max: max,
                            
                            // åŸå§‹æ•°æ®ä¿¡æ¯
                            rawData: arr,
                            outlierCount: arr.filter(x => x < lowerBound || x > upperBound).length
                        };
                    });
                    
                    // ä½¿ç”¨æ¡å½¢å›¾æ˜¾ç¤ºä¸­ä½æ•°ï¼Œä½†æä¾›å®Œæ•´çš„ç®±å½¢å›¾ä¿¡æ¯
                    return {
                        ...baseConfig,
                        type: 'bar',
                        data: {
                            labels: dataset.labels,
                            datasets: [{
                                label: 'è´¨é‡ä¸­ä½æ•°',
                                data: boxplotData.map(d => d.median),
                                backgroundColor: [
                                    themeColors.primary + '80',
                                    themeColors.secondary + '80',
                                    themeColors.success + '80',
                                    themeColors.warning + '80',
                                    themeColors.info + '80'
                                ],
                                borderColor: [
                                    themeColors.primary,
                                    themeColors.secondary,
                                    themeColors.success,
                                    themeColors.warning,
                                    themeColors.info
                                ],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            ...baseConfig,
                            plugins: {
                                ...baseConfig.plugins,
                                title: {
                                    display: true,
                                    text: dataset.description.split('ï¼š')[0] + ' - ä¸­ä½æ•°åˆ†å¸ƒ',
                                    color: themeColors.text,
                                    font: { size: 16, weight: 'bold' }
                                },
                                tooltip: {
                                    ...baseConfig.plugins.tooltip,
                                    callbacks: {
                                        label: function(context) {
                                            const boxplot = boxplotData[context.dataIndex];
                                            return [
                                                `æœ€å°å€¼: ${boxplot.min}`,
                                                `ä¸‹å››åˆ†ä½æ•°(Q1): ${boxplot.q1}`,
                                                `ä¸­ä½æ•°: ${boxplot.median}`,
                                                `ä¸Šå››åˆ†ä½æ•°(Q3): ${boxplot.q3}`,
                                                `æœ€å¤§å€¼: ${boxplot.max}`,
                                                `å¼‚å¸¸å€¼: ${boxplot.outlierCount} ä¸ª`,
                                                `æ•°æ®ç‚¹æ•°: ${boxplot.rawData.length}`
                                            ];
                                        }
                                    }
                                }
                            },
                            scales: {
                                ...baseConfig.scales,
                                y: {
                                    ...baseConfig.scales.y,
                                    beginAtZero: false,
                                    title: {
                                        display: true,
                                        text: dataset.unit,
                                        color: themeColors.text
                                    },
                                    min: Math.min(...boxplotData.map(d => d.min)) - 5,
                                    max: Math.max(...boxplotData.map(d => d.max)) + 5
                                }
                            }
                        }
                    };

                case 'bar':
                    return {
                        ...baseConfig,
                        type: 'bar',
                        data: {
                            labels: dataset.labels,
                            datasets: dataset.seriesLabels ? dataset.data.map((data, index) => ({
                                label: dataset.seriesLabels[index],
                                data: data,
                                backgroundColor: [
                                    themeColors.primary,
                                    themeColors.secondary,
                                    themeColors.success,
                                    themeColors.warning
                                ][index % 4] + '80',
                                borderColor: [
                                    themeColors.primary,
                                    themeColors.secondary,
                                    themeColors.success,
                                    themeColors.warning
                                ][index % 4],
                                borderWidth: 2
                            })) : [{
                                label: dataset.description.split('ï¼š')[0],
                                data: dataset.data,
                                backgroundColor: themeColors.primary + '80',
                                borderColor: themeColors.primary,
                                borderWidth: 2
                            }]
                        },
                        options: {
                            ...baseConfig,
                            plugins: {
                                ...baseConfig.plugins,
                                title: {
                                    display: true,
                                    text: dataset.description.split('ï¼š')[0],
                                    color: themeColors.text,
                                    font: { size: 16, weight: 'bold' }
                                }
                            },
                            scales: {
                                ...baseConfig.scales,
                                y: {
                                    ...baseConfig.scales.y,
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: dataset.unit,
                                        color: themeColors.text
                                    }
                                }
                            }
                        }
                    };

                case 'radar':
                    return {
                        ...baseConfig,
                        type: 'radar',
                        data: {
                            labels: dataset.labels,
                            datasets: dataset.data.map((data, index) => ({
                                label: dataset.seriesLabels[index],
                                data: data,
                                backgroundColor: [
                                    themeColors.primary + '40',
                                    themeColors.secondary + '40',
                                    themeColors.success + '40',
                                    themeColors.warning + '40',
                                    themeColors.info + '40'
                                ][index % 5],
                                borderColor: [
                                    themeColors.primary,
                                    themeColors.secondary,
                                    themeColors.success,
                                    themeColors.warning,
                                    themeColors.info
                                ][index % 5],
                                borderWidth: 2,
                                pointBackgroundColor: [
                                    themeColors.primary,
                                    themeColors.secondary,
                                    themeColors.success,
                                    themeColors.warning,
                                    themeColors.info
                                ][index % 5],
                                pointBorderColor: '#ffffff',
                                pointHoverBackgroundColor: '#ffffff',
                                pointHoverBorderColor: [
                                    themeColors.primary,
                                    themeColors.secondary,
                                    themeColors.success,
                                    themeColors.warning,
                                    themeColors.info
                                ][index % 5],
                                pointHoverBorderWidth: 3,
                                pointRadius: 4,
                                pointHoverRadius: 6
                            }))
                        },
                        options: {
                            ...baseConfig,
                            plugins: {
                                ...baseConfig.plugins,
                                title: {
                                    display: true,
                                    text: dataset.description.split('ï¼š')[0],
                                    color: themeColors.text,
                                    font: { size: 16, weight: 'bold' }
                                },
                                tooltip: {
                                    ...baseConfig.plugins.tooltip,
                                    callbacks: {
                                        label: function(context) {
                                            const datasetLabel = context.dataset.label;
                                            const month = context.label;
                                            const value = context.parsed.r;
                                            return `${datasetLabel} - ${month}: ${value} ${dataset.unit}`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                r: {
                                    angleLines: { 
                                        color: themeColors.grid,
                                        lineWidth: 1
                                    },
                                    grid: { 
                                        color: themeColors.grid,
                                        circular: true
                                    },
                                    pointLabels: { 
                                        color: themeColors.text,
                                        font: { size: 12, weight: 'bold' }
                                    },
                                    ticks: { 
                                        color: themeColors.text,
                                        backdropColor: 'transparent',
                                        stepSize: 20,
                                        maxTicksLimit: 6
                                    },
                                    beginAtZero: true,
                                    suggestedMin: 0,
                                    suggestedMax: 100
                                }
                            },
                            elements: {
                                line: {
                                    tension: 0.2
                                }
                            }
                        }
                    };
            }
        }

        // åˆ‡æ¢å›¾è¡¨ç±»å‹
        function switchChartType(type) {
            currentChartType = type;
            
            // æ ¹æ®å›¾è¡¨ç±»å‹è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„æ•°æ®é›†
            let datasetType = 'trigonometry'; // é»˜è®¤
            switch(type) {
                case 'boxplot':
                    datasetType = 'quality';
                    break;
                case 'scatter':
                    datasetType = 'movie';
                    break;
                case 'bar':
                    datasetType = 'sales';
                    break;
                case 'radar':
                    datasetType = 'trend';
                    break;
                default:
                    datasetType = 'trigonometry';
            }
            currentDataset = datasetType;
            
            // æ›´æ–°ä¸‹æ‹‰èœå•
            document.querySelector('.dataset-select').value = datasetType;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
            
            // æ‰¾åˆ°å¯¹åº”çš„æŒ‰é’®å¹¶æ¿€æ´»
            const buttons = document.querySelectorAll('.chart-btn');
            for (let btn of buttons) {
                if (btn.textContent.includes(getChartTypeDisplayName(type))) {
                    btn.classList.add('active');
                    break;
                }
            }
            
            initChart();
        }
        
        // è·å–å›¾è¡¨ç±»å‹æ˜¾ç¤ºåç§°
        function getChartTypeDisplayName(type) {
            const names = {
                'line': 'æŠ˜çº¿å›¾',
                'scatter': 'æ•£ç‚¹å›¾',
                'boxplot': 'ç®±å½¢å›¾',
                'bar': 'æŸ±å½¢å›¾',
                'radar': 'é›·è¾¾å›¾'
            };
            return names[type] || type;
        }

        // åˆ‡æ¢æ•°æ®é›†
        function switchDataset(dataset) {
            currentDataset = dataset;
            initChart();
        }

        // åˆ‡æ¢ä¸»é¢˜
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            
            // æ›´æ–°é¡µé¢èƒŒæ™¯è‰²
            if (isDarkTheme) {
                document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
            } else {
                document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }
            
            initChart();
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const dataset = datasets[currentDataset];
            const statsContainer = document.getElementById('dataStats');
            
            let statsHTML = '';
            
            if (currentChartType === 'line' || currentChartType === 'scatter') {
                const values = dataset.y1 || dataset.y;
                const maxValue = Math.max(...values).toFixed(2);
                const minValue = Math.min(...values).toFixed(2);
                const avgValue = (values.reduce((a, b) => a + b, 0) / values.length).toFixed(2);
                
                statsHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${maxValue}</div>
                        <div class="stat-label">æœ€å¤§å€¼</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${minValue}</div>
                        <div class="stat-label">æœ€å°å€¼</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${avgValue}</div>
                        <div class="stat-label">å¹³å‡å€¼</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${values.length}</div>
                        <div class="stat-label">æ•°æ®ç‚¹æ•°</div>
                    </div>
                `;
            } else if (currentChartType === 'boxplot') {
                const totalSamples = dataset.data.flat().length;
                const groups = dataset.labels.length;
                
                statsHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${groups}</div>
                        <div class="stat-label">å·¥è‰ºç»„æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${totalSamples}</div>
                        <div class="stat-label">æ€»æ ·æœ¬æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${dataset.data[0].length}</div>
                        <div class="stat-label">æ ·æœ¬æ•°/ç»„</div>
                    </div>
                `;
            } else if (currentChartType === 'bar') {
                const values = Array.isArray(dataset.data[0]) ? dataset.data.flat() : dataset.data;
                const maxValue = Math.max(...values);
                const minValue = Math.min(...values);
                const totalValue = values.reduce((a, b) => a + b, 0);
                
                statsHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${maxValue.toLocaleString()}</div>
                        <div class="stat-label">æœ€é«˜å€¼</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${minValue.toLocaleString()}</div>
                        <div class="stat-label">æœ€ä½å€¼</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${totalValue.toLocaleString()}</div>
                        <div class="stat-label">æ€»å€¼</div>
                    </div>
                `;
            } else if (currentChartType === 'radar') {
                // é›·è¾¾å›¾ä¸“ç”¨ç»Ÿè®¡ä¿¡æ¯
                const products = dataset.seriesLabels;
                const monthlyData = dataset.data;
                
                statsHTML = `
                    <div class="stat-item">
                        <div class="stat-value">${products.length}</div>
                        <div class="stat-label">äº§å“æ•°é‡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${dataset.labels.length}</div>
                        <div class="stat-label">ç»Ÿè®¡ç»´åº¦</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${Math.max(...monthlyData.flat()).toLocaleString()}</div>
                        <div class="stat-label">æœ€é«˜æœˆé”€é‡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${Math.min(...monthlyData.flat()).toLocaleString()}</div>
                        <div class="stat-label">æœ€ä½æœˆé”€é‡</div>
                    </div>
                `;
            }
            
            statsContainer.innerHTML = statsHTML;
        }

        // æ›´æ–°å›¾è¡¨æè¿°
        function updateDescription() {
            const description = document.getElementById('chartDescription');
            const dataset = datasets[currentDataset];
            
            description.textContent = dataset.description;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initChart();
        });

        // æ·»åŠ çª—å£å¤§å°å˜åŒ–ç›‘å¬
        window.addEventListener('resize', function() {
            if (chart) {
                chart.resize();
            }
        });
    </script>
</body>
</html>